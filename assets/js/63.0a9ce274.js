(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{567:function(e,t,n){"use strict";n.r(t);var o=n(4),i=Object(o.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"client-credentials"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#client-credentials"}},[e._v("#")]),e._v(" Client credentials")]),e._v(" "),t("h2",{attrs:{id:"quick-oidc-overview"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#quick-oidc-overview"}},[e._v("#")]),e._v(" Quick OIDC overview")]),e._v(" "),t("p",[e._v("User authentication in openEO is handled with the OpenID Connect (OIDC) protocol.\nIn most cases and contexts, users will authenticate with OIDC authentication flows\nlike the Authorization Code Flow (e.g. when using the openEO Web Editor)\nor the Device Code Flow (e.g. when using the openEO Python client).\nThese flows typically involve some form of user interaction in a web browser at some point\nto complete the authentication.")]),e._v(" "),t("h3",{attrs:{id:"client-credentials-flow"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#client-credentials-flow"}},[e._v("#")]),e._v(" Client credentials flow")]),e._v(" "),t("p",[e._v('Some use cases require a non-interactive or "machine-to-machine" way of authentication,\ne.g. to allow running processing workflows in unattended environments.\nIn OIDC this is typically achieved with the "Client Credentials" flow.\nThis is a non-interactive flow based on a static client ID and client secret.\nOften, it is also referred to as "service account" authentication.')]),e._v(" "),t("p",[e._v("The openEO Python client library has built-in support for service accounts and the client credentials flow,\nwith the "),t("a",{attrs:{href:"https://open-eo.github.io/openeo-python-client/auth.html#oidc-authentication-client-credentials-flow",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("authenticate_oidc_client_credentials()")]),e._v(" method"),t("OutboundLink")],1),e._v("\nas follows:")]),e._v(" "),t("div",{staticClass:"language-python extra-class"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[e._v("connection"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("authenticate_oidc_client_credentials"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("\n    client_id"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    client_secret"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Note: Do not hardcode the secret here!")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),t("h2",{attrs:{id:"registering-a-new-oidc-client-for-openeo-platform-with-egi-check-in"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#registering-a-new-oidc-client-for-openeo-platform-with-egi-check-in"}},[e._v("#")]),e._v(" Registering a new OIDC client for openEO Platform with EGI Check-in")]),e._v(" "),t("p",[e._v("As illustrated above, using client credentials for authentication involves a "),t("em",[e._v("client ID")]),e._v(" and "),t("em",[e._v("client secret")]),e._v(".\nThis practically means that one has to register a new OIDC client with the OIDC provider.")]),e._v(" "),t("p",[e._v("openEO Platform uses "),t("a",{attrs:{href:"https://www.egi.eu/service/check-in/",target:"_blank",rel:"noopener noreferrer"}},[e._v("EGI Check-in"),t("OutboundLink")],1),e._v(" as the OIDC identity provider (IdP).\nWhile EGI Check-in itself provides extensive documentation on "),t("a",{attrs:{href:"https://docs.egi.eu/providers/check-in/sp/#openid-connect-service-provider",target:"_blank",rel:"noopener noreferrer"}},[e._v("how to register as OIDC Service Provider in general"),t("OutboundLink")],1),e._v(",\nhere we provide a more focused guide on how to register a new OIDC client specifically for client credentials in openEO Platform.")]),e._v(" "),t("p",[t("a",{attrs:{id:"egi-enviroments"}})]),e._v(" "),t("h3",{attrs:{id:"some-notes-on-egi-environments-and-openeo-platform-support"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#some-notes-on-egi-environments-and-openeo-platform-support"}},[e._v("#")]),e._v(" Some notes on EGI environments and openEO Platform support")]),e._v(" "),t("p",[e._v('EGI Check-in provides three environments: "production", "demo" and "development"\n(each of which corresponds to '),t("a",{attrs:{href:"https://docs.egi.eu/providers/check-in/sp/#endpoints",target:"_blank",rel:"noopener noreferrer"}},[e._v("different OIDC endpoints"),t("OutboundLink")],1),e._v(").")]),e._v(" "),t("p",[e._v("After you initiate the procedure to create a new OIDC client in the production and demo environments,\nyou have to wait for "),t("em",[e._v("approval by an EGI administrator")]),e._v(".\nClients created in the development environment can be self-reviewed without the need to wait for official approval,\nwhich is handy if you just want to test out the client credentials flow for your use case,\nbut don't want to spend too much time upfront on fine-tuning all the registration details.")]),e._v(" "),t("p",[e._v("Note however that the EGI environments are also linked to the openEO Platform environments:")]),e._v(" "),t("ul",[t("li",[e._v("The production instance of openEO Platform\n(at "),t("a",{attrs:{href:"https://openeo.cloud/",target:"_blank",rel:"noopener noreferrer"}},[e._v("openeo.cloud"),t("OutboundLink")],1),e._v(")\nonly works with the production environment of EGI Check-in.")]),e._v(" "),t("li",[e._v("The development instance of openEO Platform\nat ("),t("a",{attrs:{href:"https://openeocloud-dev.vito.be/",target:"_blank",rel:"noopener noreferrer"}},[e._v("openeocloud-dev.vito.be"),t("OutboundLink")],1),e._v(")\nsupports both the production environment of EGI Check-in (the default)\nas well as the development environment of EGI Check-in,\nbut that has to be specified explicitly,\ne.g. by providing and additional "),t("code",[e._v('provider_id="egi-dev"')]),e._v(" when calling "),t("code",[e._v("authenticate_oidc_client_credentials()")]),e._v(".")])]),e._v(" "),t("h3",{attrs:{id:"step-by-step-guide-to-register-a-new-oidc-client-for-client-credentials"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-by-step-guide-to-register-a-new-oidc-client-for-client-credentials"}},[e._v("#")]),e._v(" Step-by-step guide to register a new OIDC client for client credentials")]),e._v(" "),t("ol",[t("li",[e._v("Go to the "),t("a",{attrs:{href:"https://aai.egi.eu/federation",target:"_blank",rel:"noopener noreferrer"}},[e._v("EGI Federation Registry"),t("OutboundLink")],1),e._v(" and log in")]),e._v(" "),t("li",[e._v('Click on "Manage services" on the left menu bar')]),e._v(" "),t("li",[e._v('Click "+ New service" button to start creating a new service')])]),e._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v('That the form you are facing now has two tabs: "General" and "Protocol Specific".\nYou have to fill in both tabs fully before you can submit this form.\nAlso note that if there is something wrong or missing in the form,\nthe error messages might not always be very clear about which tab they refer to.')])]),e._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("p",[e._v("Fill in the first tab with general information.\nAlso see the "),t("a",{attrs:{href:"https://docs.egi.eu/providers/check-in/sp/#general-information",target:"_blank",rel:"noopener noreferrer"}},[e._v("EGI Check-in documentation on general client information"),t("OutboundLink")],1),e._v(".\nSome additional notes:")]),e._v(" "),t("ul",[t("li",[e._v('Pick the desired "Integration Environment": "Production" or "Development" as discussed '),t("a",{attrs:{href:"#egi-enviroments"}},[e._v("above")])]),e._v(" "),t("li",[e._v("Contacts: you have to enter at least one email address for each of the types (admin, technical, support, security).")])])]),e._v(" "),t("li",[t("p",[e._v('Switch to the second tab "Protocol Specific" and select "OIDC Service"')])]),e._v(" "),t("li",[t("p",[e._v("Fill in the OIDC specific sub form, with most importantly:")]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("Client ID")]),e._v(": This is the ID that you will use in your client code to identify your client.\nIt should be unique within the OIDC provider, so make sure to pick a descriptive and meaningful name.\nYou can also choose to leave it empty to let the OIDC provider generate one for you.")]),e._v(" "),t("li",[t("strong",[e._v("Application Type")]),e._v(': leave it at "Web"')]),e._v(" "),t("li",[t("strong",[e._v("Grant Types")]),e._v(': only enable "client credentials" (disable other options that might be enabled by default).')]),e._v(" "),t("li",[t("strong",[e._v("Token Endpoint Authorization Method")]),e._v(': leave it at "Client Secret over HTTP Basic"')]),e._v(" "),t("li",[t("strong",[e._v("Client Secret")]),e._v(": leave the checkbox enabled")]),e._v(" "),t("li",[e._v("You can leave all other fields as they are")])])]),e._v(" "),t("li",[t("p",[e._v('Click "Submit" to create the new OIDC client.\nIf there are any errors or missing information, you will be notified about them.\nAs mentioned, make sure to verify both tabs for any missing or incorrect information.')])]),e._v(" "),t("li",[t("p",[e._v('If submission was successful and you go to the "Manage Services" overview,\nyou should see your new service listed there, with "Registration Pending" status.')])]),e._v(" "),t("li",[t("p",[e._v('If you picked the production environment, you have to wait now for approval by an EGI administrator.\nYou should get approval related emails on the "admin" email address provided earlier.')]),e._v(" "),t("p",[e._v('If you picked the development environment, you can self-approve the client as follows.\nClick the corresponding "Review" button on service overview to go to a review view of the client information.\nClick the "Review" button at the top to fold out a more detailed review form.\nSelect the "Approve" option and click the "Submit Review" button.\nYour client should now be approved and ready to use:\nthe status on service overview should now state "Deployed".')])])]),e._v(" "),t("h2",{attrs:{id:"caveats-and-security-considerations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#caveats-and-security-considerations"}},[e._v("#")]),e._v(" Caveats and security considerations")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Treat the client secret securely, like a password.\nTake extra care to not leak it accidentally.\nFor example, given the simplicity of the "),t("code",[e._v("authenticate_oidc_client_credentials()")]),e._v(" example snippet above,\nit might be tempting to hard-code the client secret in scripts or notebooks,\npotentially leading to its permanent storage in version control repositories.")]),e._v(" "),t("p",[e._v("Instead, read the client secret from a secure location\n(e.g. a private file outside the reach of the version control repositories),\nor leverage environment variables (e.g as directly "),t("a",{attrs:{href:"https://open-eo.github.io/openeo-python-client/auth.html#oidc-client-credentials-using-environment-variables",target:"_blank",rel:"noopener noreferrer"}},[e._v("supported by the openEO Python client library"),t("OutboundLink")],1),e._v(").")])]),e._v(" "),t("li",[t("p",[e._v("The client credentials only identify an OAuth "),t("em",[e._v("client")]),e._v(" or "),t("em",[e._v("service account")]),e._v(",\nnot a personal "),t("em",[e._v("user")]),e._v(" account.\nThis means that openEO resources such as openEO batch jobs, their results, UDP's, etc\nfrom one identity are not available to the other.\nFor example, batch jobs originally created with a service account\ncannot be listed when using a personal account.")])]),e._v(" "),t("li",[t("p",[e._v("The client credentials flow is not supported in the openEO Web Editor.\nAs mentioned above,\nthis practically means that it can not be used to track the progress and\nstatus of batch jobs created with a service account.\nHowever, it is still possible to approximate the batch job overview of the web editor\nwith a Jupyter Notebook using the openEO Python client library.")])])])])}),[],!1,null,null,null);t.default=i.exports}}]);